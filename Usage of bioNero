library(BioNERO)
set.seed(123) # set seed for reproducibility
# gene expression data (tpm)
exp <- read.delim("E-GEOD-110315_eQTL_gene_exp.tpms.tsv", 
                  header = TRUE, 
                  sep = "\t", 
                  comment.char = "#", 
                  stringsAsFactors = FALSE, 
                  check.names = FALSE)

exp <- na.omit(exp) # remove nas

# transcription factor list
tf_ID <- read.csv("tf_list.txt")

# make a header "GeneID"
colnames(tf_ID) <- c("GeneID")

# make sure the list unique
tf_list <- unique(tf_ID$GeneID)

#compute GRN(this command uses GENIE3, ARACNe, and CLR to compute the GRN simultaneously
grn_list <- grn_combined(exp, regulators = tf_list, eps=0, nTrees = 10, remove_zero = FALSE)
#head(grn_list$genie3)
#head(grn_list$aracne)
#head(grn_list$clr)

# to compute the GRN in separate models
genie3 <- grn_infer(
    exp, 
    method = "genie3", # or any other model
    regulators = tf_list, 
    nTrees = 10)
